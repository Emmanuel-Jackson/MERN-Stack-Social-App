{"ast":null,"code":"import _regeneratorRuntime from\"/home/emjackson/MERN Stack Social App/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/home/emjackson/MERN Stack Social App/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/home/emjackson/MERN Stack Social App/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/emjackson/MERN Stack Social App/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{Card,CardActions,CardContent,CardMedia,Button,ButtonBase,Typography}from'@material-ui/core/';import FavoriteIcon from'@material-ui/icons/Favorite';import FavoriteBorderIcon from'@material-ui/icons/FavoriteBorder';import DeleteIcon from'@material-ui/icons/Delete';import EditIcon from'@material-ui/icons/Edit';import moment from'moment';import useStyles from'./styles';import{useDispatch}from'react-redux';import{deletePost,likePost}from'../../../actions/posts';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Post(_ref){var _user$result,_user$result2,_user$result3;var post=_ref.post,setCurrentId=_ref.setCurrentId;var classes=useStyles();var dispatch=useDispatch();var navigate=useNavigate();var user=JSON.parse(localStorage.getItem('profile'));var _useState=useState(post===null||post===void 0?void 0:post.likes),_useState2=_slicedToArray(_useState,2),likes=_useState2[0],setLikes=_useState2[1];var userId=user===null||user===void 0?void 0:(_user$result=user.result)===null||_user$result===void 0?void 0:_user$result._id;var hasLikedPost=likes.find(function(like){return like===userId;});var handleLike=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(likePost(post._id));if(hasLikedPost){setLikes(post.likes.filter(function(id){return id!==userId;}));}else{setLikes([].concat(_toConsumableArray(post.likes),[userId]));}case 2:case\"end\":return _context.stop();}}},_callee);}));return function handleLike(){return _ref2.apply(this,arguments);};}();var Likes=function Likes(){if(likes.length>0){return likes.find(function(like){return like===userId;})?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FavoriteIcon,{style:{color:'red'},fontSize:\"small\"}),\"\\xA0\",likes.length>2?\"You and \".concat(likes.length-1,\" others\"):\"\".concat(likes.length,\" like\").concat(likes.length>1?'s':'')]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FavoriteBorderIcon,{fontSize:\"small\"}),\"\\xA0\",likes.length,\" \",likes.length===1?'Like':'Likes']});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FavoriteBorderIcon,{fontSize:\"small\"}),\"\\xA0Like\"]});};var openPost=function openPost(e){// dispatch(getPost(post._id, navigate));\nnavigate(\"/posts/\".concat(post._id));};return/*#__PURE__*/_jsxs(Card,{className:classes.card,raised:true,elevation:1,children:[/*#__PURE__*/_jsxs(ButtonBase,{component:\"span\",name:\"test\",className:classes.cardAction,onClick:openPost,children:[/*#__PURE__*/_jsx(CardMedia,{className:classes.media,image:post.selectedFile||\"https://user-images.githubusercontent.com/194400/49531010-48dad180-f8b1-11e8-8d89-1e61320e1d82.png\",title:post.title}),/*#__PURE__*/_jsxs(\"div\",{className:classes.overlay,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:post.name}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:moment(post.createdAt).fromNow()})]}),(user===null||user===void 0?void 0:(_user$result2=user.result)===null||_user$result2===void 0?void 0:_user$result2._id)===(post===null||post===void 0?void 0:post.creator)&&/*#__PURE__*/_jsx(\"div\",{className:classes.overlay2,name:\"edit\",children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(e){e.stopPropagation();setCurrentId(post._id);},style:{color:'white'},size:\"small\",children:/*#__PURE__*/_jsx(EditIcon,{fontSize:\"default\"})})}),/*#__PURE__*/_jsx(\"div\",{className:classes.details,children:/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",variant:\"body2\",children:post.tags.map(function(tags){return\"#\".concat(tags,\" \");})})}),/*#__PURE__*/_jsx(Typography,{gutterBottom:true,variant:\"h5\",className:classes.title,children:post.title}),/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",component:\"p\",children:post.message})})]}),/*#__PURE__*/_jsxs(CardActions,{className:classes.cardActions,children:[/*#__PURE__*/_jsx(Button,{size:\"small\",disabled:!(user!==null&&user!==void 0&&user.result),onClick:handleLike,children:/*#__PURE__*/_jsx(Likes,{})}),(user===null||user===void 0?void 0:(_user$result3=user.result)===null||_user$result3===void 0?void 0:_user$result3._id)===(post===null||post===void 0?void 0:post.creator)&&/*#__PURE__*/_jsxs(Button,{size:\"small\",color:\"primary\",onClick:function onClick(){return dispatch(deletePost(post._id));},children:[/*#__PURE__*/_jsx(DeleteIcon,{fontSize:\"small\"}),\"Delete\"]})]})]});}export default Post;","map":{"version":3,"names":["React","useState","Card","CardActions","CardContent","CardMedia","Button","ButtonBase","Typography","FavoriteIcon","FavoriteBorderIcon","DeleteIcon","EditIcon","moment","useStyles","useDispatch","deletePost","likePost","useNavigate","Post","post","setCurrentId","classes","dispatch","navigate","user","JSON","parse","localStorage","getItem","likes","setLikes","userId","result","_id","hasLikedPost","find","like","handleLike","filter","id","Likes","length","color","openPost","e","card","cardAction","media","selectedFile","title","overlay","name","createdAt","fromNow","creator","overlay2","stopPropagation","details","tags","map","message","cardActions"],"sources":["/home/emjackson/MERN Stack Social App/client/src/components/Posts/Post/Post.js"],"sourcesContent":["import React, { useState } from 'react'\nimport { Card, CardActions, CardContent, CardMedia, Button, ButtonBase, Typography } from '@material-ui/core/';\nimport FavoriteIcon from '@material-ui/icons/Favorite';\nimport FavoriteBorderIcon from '@material-ui/icons/FavoriteBorder';\nimport DeleteIcon from '@material-ui/icons/Delete'\nimport EditIcon from '@material-ui/icons/Edit';\nimport moment from 'moment'\nimport useStyles from './styles'\nimport { useDispatch } from 'react-redux'\n\nimport { deletePost, likePost } from '../../../actions/posts'\nimport { useNavigate } from 'react-router-dom';\nfunction Post({ post, setCurrentId}) {\n\n  const classes = useStyles();\n  const dispatch = useDispatch()\n  const navigate = useNavigate()\n  const user = JSON.parse(localStorage.getItem('profile'))\n\n  const [likes, setLikes] = useState(post?.likes)\n  const userId = user?.result?._id;\n\n  const hasLikedPost = likes.find((like) => like === userId)\n  const handleLike = async () => {\n    dispatch(likePost(post._id))\n\n    if (hasLikedPost) {\n      setLikes(post.likes.filter((id) => id !== userId));\n    } else {\n      setLikes([...post.likes, userId]);\n    }\n  }\n\n  const Likes = () => {\n    if (likes.length > 0) {\n      return likes.find((like) => like === userId)\n        ? (\n          <><FavoriteIcon style={{ color: 'red' }} fontSize=\"small\" />&nbsp;{likes.length > 2 ? `You and ${likes.length - 1} others` : `${likes.length} like${likes.length > 1 ? 's' : ''}` }</>\n        ) : (\n          <><FavoriteBorderIcon fontSize=\"small\" />&nbsp;{likes.length} {likes.length === 1 ? 'Like' : 'Likes'}</>\n        );\n    }\n\n    return <><FavoriteBorderIcon fontSize=\"small\" />&nbsp;Like</>;\n  };\n  const openPost = (e) => {\n    // dispatch(getPost(post._id, navigate));\n\n    navigate(`/posts/${post._id}`);\n  };\n \n  return (\n    <Card className={classes.card} raised elevation={1}>\n      <ButtonBase\n        component=\"span\"\n        name=\"test\"\n        className={classes.cardAction}\n        onClick={openPost}\n      >\n      <CardMedia className={classes.media} image={post.selectedFile || \"https://user-images.githubusercontent.com/194400/49531010-48dad180-f8b1-11e8-8d89-1e61320e1d82.png\"} title={post.title}/>\n      <div className={classes.overlay}>\n        <Typography variant='h6'>{post.name}</Typography>\n        <Typography variant='body2'>{moment(post.createdAt).fromNow()}</Typography>\n      </div>\n      {(user?.result?._id === post?.creator) && (\n        <div className={classes.overlay2} name=\"edit\">\n          <Button\n            onClick={(e) => {\n              e.stopPropagation();\n              setCurrentId(post._id);\n            }}\n            style={{ color: 'white' }}\n            size=\"small\"\n          >\n            <EditIcon fontSize=\"default\" />\n          </Button>\n        </div>\n      )}\n        <div className={classes.details}>\n          <Typography color='textSecondary' variant='body2'>{post.tags.map((tags) => `#${tags} `)}</Typography>\n        </div>\n        <Typography gutterBottom variant='h5' className={classes.title}>{post.title}</Typography>\n        <CardContent>\n        <Typography variant='body2' color=\"textSecondary\" component=\"p\">{post.message}</Typography>\n        </CardContent>\n        </ButtonBase>\n        <CardActions className={classes.cardActions}>\n          <Button size=\"small\" disabled={!user?.result} onClick={handleLike}>\n            <Likes />\n          </Button>\n          {(user?.result?._id === post?.creator) && (\n          <Button size=\"small\" color='primary' onClick={() => dispatch(deletePost(post._id))}>\n            <DeleteIcon fontSize='small' />\n             Delete\n            </Button>\n          )}\n        </CardActions>\n    </Card>\n  )\n}\n\nexport default Post"],"mappings":"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"},"metadata":{},"sourceType":"module"}